# Деплой сервиса с прогнозом стоимости машины.

## Ноутбук:

- [Ноутбук](AI_HW1_Regression_with_inference_pro.ipynb)

## Созданное веб-приложение

- [Открыть](https://price-prediction-app-byp6gqjlgd6ru7wnmm9s6q.streamlit.app/)

## Ноутбук:

- [Файл, который можно протестировать](data_for_test.csv)

## Запуск локально

**Как создать и активировать окружение**

```bash
python3.11 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

**Запуск:**

```bash
streamlit run app.py
```

**Структура репозитория:**

```
.
├── AI_HW1_Regression_with_inference_pro.ipynb # Ноутбук
├── app.py                                     # Streamlit-приложение
├── requirements.txt                           # Зависимости
├── README.md                                  # Readme файл
└── model                                      # Модели
    └── feature_names.pkl                      # Файл с фичами
    └── price_prediction_model.pkl             # Файл с обученной моделью
```

# Прогнозирование стоимости автомобилей

## Задача
Научиться предсказывать стоимость автомобиля на основе его характеристик.

## Разведочный анализ данных (EDA)
- Исследованы корреляции признаков с целевой переменной.
- Проанализированы распределения признаков.
- Обработаны пропущенные значения и аномалии.

## Предобработка данных
- Кодирование категориальных признаков.
- Масштабирование числовых признаков.
- Создание новых признаков, включая обработку строки `Name`, которая содержит много полезной информации.

## Моделирование
- Эксперименты с линейными моделями: линейная регрессия, Ridge, Lasso.
- Проверка различных комбинаций признаков, гиперпараметров и методов регуляризации.
- Была так же использована кросс-валидация для общей оценки моделей.
- Ключевые метрики: R² и MSE.

## Основные наблюдения
- Простая линейная регрессия на первых шагах показала слабые результаты.
- Добавление категориальных признаков и использование регуляризации улучшило качество модели: R² на тестовой выборке вырос с 0.6 до ~0.82.
- Сильная связь между `selling_price` и характеристиками двигателя: `max_power` (0.872), `torque` (0.752), `engine` (0.504).
- Наиболее важные признаки: мощность двигателя и год выпуска автомобиля.
- Строка `Name` содержит еще больше информации, которую можно дополнительно использовать (например, закодировать числовые признаки по диапазонам).

## Оценка разработанного сервиса
- Визуально понятно, как характеристики автомобиля влияют на прогнозируемую стоимость.
- Распределения и корреляции хорошо показаны, но визуализация важности признаков требует улучшений.
- Streamlit оказался простым и удобным инструментом.
- Планируется переход от линейных моделей к бустинговым методам с использованием SHAP для интерпретации.

